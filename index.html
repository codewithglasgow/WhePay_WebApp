<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
    <style>
        :root { 
            --bg: #000; 
            --card: #1c1c1e; 
            --accent: #007AFF; 
            --success: #32d74b; 
            --warn: #ff9f0a; 
            --danger: #ff453a; 
            --sec: #8e8e93; 
            --purple: #af52de; 
            --neon: #00f2ff; 
            --dark-bg: #020617;
            --slate: #1e293b;
        }
        
        * {
            box-sizing: border-box;
        }
        
        body { 
            background: var(--bg); 
            color: #fff; 
            font-family: -apple-system, sans-serif;
            margin: 0; 
            padding: 0;
            overflow-x: hidden;
        }
        
        /* NEW Ticker Styles */
        .ticker-fixed { 
            background: linear-gradient(to bottom, #111, #000); 
            border-bottom: 1px solid #333; 
            padding: 0px 12px; 
            position: sticky; 
            top: 0; 
            z-index: 1000; 
            width: 100%; 
            box-shadow: 0 4px 10px rgba(0,0,0,0.6);
            height: 75px;
            display: flex;
            align-items: center;
            overflow: hidden;
        }

        .ticker-ribbon { 
            display: flex; 
            gap: 30px; 
            animation: scroll 20s linear infinite;
            white-space: nowrap; 
            padding-left: 20px;
            will-change: transform;
        }
        
        @keyframes scroll { 
            from { transform: translateX(0); } 
            to { transform: translateX(-100%); } 
        }
        
        .live-dot { 
            display: inline-flex; 
            align-items: center; 
            gap: 8px; 
            color: #ff0000; 
            font-weight: bold; 
            font-size: 16px; 
            flex-shrink: 0; 
            animation: pulse-red 1.8s infinite; 
            margin-right: 20px; 
        }
        .live-dot::before { 
            content: "‚óè"; 
            font-size: 18px; 
            animation: glow 1.8s infinite; 
        }
        @keyframes glow { 
            0% { 
                text-shadow: 0 0 8px #ff0000; 
            } 
            50% { 
                text-shadow: 0 0 20px #ff0000, 0 0 30px #ff4444; 
            } 
            100% { 
                text-shadow: 0 0 8px #ff0000; 
            } 
        }
        @keyframes pulse-red { 
            0% { 
                opacity: 1; 
                transform: scale(1); 
            } 
            50% { 
                opacity: 0.6; 
                transform: scale(1.1); 
            } 
            100% { 
                opacity: 1; 
                transform: scale(1); 
            } 
        }
        
        .ticker-draw {
            display: flex;
            flex-direction: column;
            align-items: center;
            margin-right: 30px;
            padding-top: 4px;
        }

        .ticker-time { 
            color: #ffa500; 
            font-weight: bold; 
            min-width: 110px; 
            text-align: right; 
        }
        
        .ticker-number { 
            width: 25px; 
            height: 25px; 
            line-height: 25px; 
            border-radius: 20px; 
            font-weight: bold; 
            font-size: 18px; 
            text-align: center; 
            color: #000; 
            box-shadow: 0 4px 12px rgba(0,0,0,0.5);
            flex-shrink: 0; 
            margin-right: 4px;
        }
        
        /* Original styles */
        .nav { 
            position: sticky; 
            top: 75px; 
            width: 100%; 
            background: rgba(28,28,30,0.9); 
            backdrop-filter: blur(20px); 
            z-index: 100; 
            padding: 12px; 
            border-bottom: 0.5px solid #333; 
            box-sizing: border-box; 
        }
        
        .search-box { 
            width: 100%; 
            background: #1c1c1e; 
            border: 1px solid #333; 
            border-radius: 8px; 
            padding: 10px; 
            color: white; 
            margin-top: 5px; 
        }
        
        .tabs { 
            display: flex; 
            gap: 6px; 
            margin-bottom: 10px; 
        }
        
        .tab { 
            flex: 1; 
            background: #2c2c2e; 
            border: none; 
            color: #fff; 
            padding: 12px; 
            border-radius: 10px; 
            font-weight: 800; 
            font-size: 14px; 
            cursor: pointer;
        }
        
        .tab.active { 
            background: var(--accent); 
        }
        
        .container { 
            padding: 10px 5px; 
        }
        
        .card { 
            background: var(--card); 
            border-radius: 14px; 
            padding: 15px; 
            margin-bottom: 12px; 
            border: 0.5px solid #2c2c2e; 
        }
        
        .ball-big { 
            width: 45px; 
            height: 45px; 
            border-radius: 50%; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            font-size: 22px; 
            font-weight: 900; 
            color: #000; 
        }
        
        .due-tag { 
            font-size: 10px; 
            font-weight: 900; 
            padding: 2px 6px; 
            border-radius: 4px; 
            margin-top: 4px; 
            display: inline-block; 
        }
        
        .panel { 
            display: none; 
            margin-top: 15px; 
            border-top: 1px solid #333; 
            padding-top: 10px; 
        }
        
        .table { 
            width: 100%; 
            font-size: 13px; 
            border-collapse: collapse; 
            margin-top: 10px; 
        }
        
        .table th { 
            text-align: left; 
            color: var(--sec); 
            font-size:10px; 
        }
        
        .table td { 
            padding: 8px 0; 
            border-bottom: 0.5px solid #222; 
        }
        
        .rank-btn { 
            background: var(--success); 
            color: #000; 
            font-weight: bold; 
            border: none; 
            width: 100%; 
            padding: 14px; 
            border-radius: 12px; 
            margin-top: 10px; 
            cursor: pointer;
        }
        
        .input-select { 
            width: 100%; 
            background: #2c2c2e; 
            border: 1px solid #3a3a3c; 
            border-radius: 10px; 
            padding: 12px; 
            color: #fff; 
            margin-bottom: 8px; 
            font-size: 14px; 
        }
        
        /* Marks Outstanding Dropdown CSS */
        .dropdown-btn {
            width: 100%;
            background: #2c2c2e;
            color: var(--success);
            border: 1px solid #444;
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            font-weight: 800;
            font-size: 14px;
            text-align: center;
            cursor: pointer;
        }
        .outstanding-panel {
            display: none;
            background: #111;
            border-radius: 10px;
            padding: 10px;
            margin-bottom: 15px;
            border: 1px solid #333;
        }
        .out-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 0.5px solid #222;
            align-items: center;
        }
        .out-label { color: var(--accent); font-weight: bold; font-size: 12px; }
        .out-nums { color: #fff; font-family: monospace; font-size: 14px; }
        .ball-small {
            display: inline-block;
            width: 22px; height: 22px; line-height: 22px;
            border-radius: 50%; text-align: center;
            font-size: 11px; font-weight: bold; margin-left: 4px;
        }

        /* QUANTUM CHART STYLES (From first code) */
        .quantum-header { 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #334155; 
            margin-bottom: 15px; 
            padding-bottom: 10px; 
        }
        
        .quantum-header h2 { 
            color: var(--neon); 
            margin: 0; 
            font-size: 18px; 
            letter-spacing: 1px; 
        }
        
        .btn-rand { 
            background: var(--danger); 
            color: white; 
            border: none; 
            padding: 8px 14px; 
            border-radius: 20px; 
            font-size: 10px; 
            font-weight: 800; 
            cursor: pointer; 
            text-transform: uppercase; 
        }
        
        .grid { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 6px; 
            margin-bottom: 15px; 
        }
        
        .triplet { 
            display: flex; 
            border: 1px solid #334155; 
            border-radius: 6px; 
            background: rgba(30, 41, 59, 0.5); 
            overflow: hidden; 
            height: 42px; 
        }
        
        .cell { 
            flex: 1; 
            display: flex; 
            align-items: center; 
            justify-content: center; 
            border-right: 1px solid #334155; 
            font-weight: 700; 
            font-size: 13px; 
            color: #94a3b8; 
            cursor: pointer; 
        }
        
        .cell.highlight { 
            background: var(--neon) !important; 
            color: #000 !important; 
        }
        
        .cell.dim { 
            opacity: 0.15; 
        }
        
        .quantum-instructions { 
            padding: 12px; 
            background: var(--slate); 
            border-radius: 8px; 
            border: 1px solid #334155; 
            min-height: 220px; 
        }
        
        .chart-tabs { 
            display: flex; 
            gap: 5px; 
            margin-bottom: 12px; 
            border-bottom: 1px solid #334155; 
            padding-bottom: 10px; 
        }
        
        .chart-tab { 
            background: #334155; 
            color: #94a3b8; 
            padding: 6px 10px; 
            border-radius: 4px; 
            font-size: 10px; 
            font-weight: bold; 
            cursor: pointer; 
            text-transform: uppercase; 
        }
        
        .chart-tab.active { 
            background: var(--neon); 
            color: #000; 
        }
        
        .comparison { 
            display: flex; 
            gap: 8px; 
            flex-direction: column;
        }
        
        @media (min-width: 768px) {
            .comparison {
                flex-direction: row;
            }
        }
        
        .column { 
            flex: 1; 
            background: rgba(0,0,0,0.3); 
            padding: 10px; 
            border-radius: 6px; 
            border: 1px solid rgba(255,255,255,0.05); 
        }
        
        .column h4 { 
            color: var(--neon); 
            font-size: 8px; 
            margin: 0 0 8px 0; 
            text-transform: uppercase; 
            border-bottom: 1px solid #334155; 
            padding-bottom: 4px; 
            text-align: center; 
        }
        
        .data-box { 
            text-align: center; 
            padding: 10px; 
        }
        
        .data-val { 
            font-size: 24px; 
            font-weight: 800; 
            color: white; 
            margin: 10px 0; 
            letter-spacing: 2px; 
        }
        
        .diamond-text { 
            font-size: 11px; 
            color: #cbd5e1; 
            font-style: italic; 
        }
        
        /* Splash & Dashboard Transitions */
        #splash-screen {
            position: fixed;
            inset: 0;
            z-index: 9999;
            background: #020617;
            display: flex;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            transition: opacity 0.8s ease-out;
        }

        .stage {
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: space-around;
            perspective: 800px;
            padding: 0 5vw;
        }

        .scene {
            width: 18vw;
            height: 18vw;
            max-width: 70px;
            max-height: 70px;
            position: relative;
        }

        .cube {
            width: 100%;
            height: 100%;
            position: absolute;
            transform-style: preserve-3d;
            transition: transform 2s cubic-bezier(0.17, 0.67, 0.83, 0.67);
        }

        .face {
            position: absolute;
            width: 100%;
            height: 100%;
            background: #ffffff;
            border-radius: 12%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: inset 0 0 10px rgba(0,0,0,0.2);
            backface-visibility: hidden;
        }

        /* Position based 18vw width (half is 9vw) */
        .face--1 { transform: rotateY(0deg) translateZ(9vw); }
        .face--2 { transform: rotateY(90deg) translateZ(9vw); }
        .face--3 { transform: rotateY(180deg) translateZ(9vw); }
        .face--4 { transform: rotateY(-90deg) translateZ(9vw); }
        .face--5 { transform: rotateX(90deg) translateZ(9vw); }
        .face--6 { transform: rotateX(-90deg) translateZ(9vw); }

        /* Cap the translateZ for larger screens using media query */
        @media (min-width: 400px) {
            .face--1 { transform: rotateY(0deg) translateZ(35px); }
            .face--2 { transform: rotateY(90deg) translateZ(35px); }
            .face--3 { transform: rotateY(180deg) translateZ(35px); }
            .face--4 { transform: rotateY(-90deg) translateZ(35px); }
            .face--5 { transform: rotateX(90deg) translateZ(35px); }
            .face--6 { transform: rotateX(-90deg) translateZ(35px); }
        }

        .dot { width: 2.5vw; height: 2.5vw; max-width: 8px; max-height: 8px; background: #111; border-radius: 50%; }
        .dots { display: grid; gap: 1vw; grid-template-columns: repeat(3, 1fr); }

        .reveal {
            text-align: center;
            opacity: 0;
            transform: translateY(20px);
            transition: all 0.8s ease-out;
            flex: 1;
        }

        .reveal.show { opacity: 1; transform: translateY(0); }

        .title { font-size: 7vw; font-weight: 900; color: #fff; margin: 0; white-space: nowrap; }
        .subtitle { font-size: 3.5vw; color: #58a6ff; margin-top: 5px; white-space: nowrap; }

        .fade-out { opacity: 0 !important; pointer-events: none; }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .tabs {
                flex-wrap: wrap;
            }
            
            .tab {
                min-width: 100px;
            }
            
            .ticker-fixed {
                height: 85px;
            }
            
            .grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }
        
        @media (max-width: 480px) {
            .title {
                font-size: 9vw;
            }
            
            .subtitle {
                font-size: 4.5vw;
            }
            
            .stage {
                flex-direction: column;
                justify-content: center;
                gap: 20px;
            }
            
            .scene {
                width: 25vw;
                height: 25vw;
                max-width: 60px;
                max-height: 60px;
            }
            
            .ticker-time {
                min-width: 90px;
                font-size: 12px;
            }
            
            .nav {
                top: 85px;
            }
        }
        
        /* Main content visibility */
        #main-content {
            display: none;
        }
        
        #main-content.show {
            display: block;
        }
    </style>
</head>
<body>
    <div id="splash-screen">
        <div class="stage">
            <div class="scene">
                <div class="cube" id="cube1"></div>
            </div>
            
            <div class="reveal" id="revealText">
                <h1 class="title">WHE PAY</h1>
                <h1 class="title">SHELF ANALYSIS</h1>
                <p class="subtitle">CODEWITHGLASGOW</p>
            </div>
            
            <div class="scene">
                <div class="cube" id="cube2"></div>
            </div>
        </div>
    </div>

    <div id="main-content">
        <!-- NEW Ticker -->
        <div class="ticker-fixed">
            <div class="ticker-ribbon" id="tickerRibbon1"></div>
            <div class="ticker-ribbon" id="tickerRibbon2"></div>
            <div class="ticker-ribbon" id="tickerRibbon3"></div>
            <div class="ticker-ribbon" id="tickerRibbon4"></div>
        </div>

        <div class="nav">
            <div style="display:flex; justify-content:space-between; margin-bottom:10px;">
                <span style="font-weight:900; font-size:18px;">WHE PAY ‚Ä¢ ANALYSIS DASHBOARD</span>
            </div>
            <div class="tabs">
                <button class="tab active" onclick="show('shelf', this)">SHELF</button>
                <button class="tab" onclick="show('draws', this)">DRAWS</button>
                <button class="tab" onclick="show('analyzer', this)">ANALYZER</button>
                <button class="tab" onclick="show('quantum', this)">QUANTUM CHART</button>
            </div>
            <input type="text" id="masterSearch" class="search-box" placeholder="Search Mark..." onkeyup="doSearch()">
            
            <button id="outBtn" class="dropdown-btn" onclick="toggleOutstanding()">üßÆ MARKS OUTSTANDING ‚ñæ</button>
            
            <div id="outstanding-table" class="outstanding-panel"></div>
        </div>
        
        <div id="shelf-tab" class="container"></div>

        <div id="draws-tab" class="container" style="display:none;"></div>

        <div id="analyzer-tab" class="container" style="display:none;">
            <div class="card" style="border-left: 5px solid var(--purple);">
                <h3 style="text-align:center; color:var(--purple); margin:0 0 15px 0;">MARK ANALYZER</h3>
                <select id="sDay" class="input-select">
                    <option value="Monday">Monday</option>
                    <option value="Tuesday">Tuesday</option>
                    <option value="Wednesday">Wednesday</option>
                    <option value="Thursday">Thursday</option>
                    <option value="Friday">Friday</option>
                    <option value="Saturday">Saturday</option>
                </select>
                <select id="sTime" class="input-select">
                    <option value="ALL">All Times</option>
                    <option value="MOR">Morning</option>
                    <option value="MID">Midday</option>
                    <option value="NON">Afternoon</option>
                    <option value="EVE">Evening</option>
                </select>
                <select id="sScope" class="input-select">
                    <option value="4">Last 4 Weeks</option>
                    <option value="8">Last 8 Weeks</option>
                    <option value="12">Last 12 Weeks</option>
                    <option value="16">Last 16 Weeks</option>
                    <option value="20">Last 20 Weeks</option>
                    <option value="24">Last 24 Weeks</option>
                    <option value="28">Last 28 Weeks</option>
                    <option value="32">Last 32 Weeks</option>
                    <option value="36">Last 36 Weeks</option>
                    <option value="40">Last 40 Weeks</option>
                    <option value="52">Last 52 Weeks</option>
                    <option value="159">Full History (159 Weeks)</option>
                </select>
                <button class="rank-btn" onclick="runDeepSearch()">RANK MARKS</button>
                <div id="res" style="margin-top:20px;"></div>
            </div>
        </div>

        <!-- QUANTUM CHART TAB (Added from first code) -->
        <div id="quantum-tab" class="container" style="display:none;">
            <div class="card">
                <div class="quantum-header">
                    <div>
                        <h2>FSP SAGi</h2>
                        <div style="font-size: 9px; color: #64748b;">QUANTUM MAPPING</div>
                    </div>
                    <button class="btn-rand" onclick="randomPick()">Quick Pick</button>
                </div>
                
                <div id="grid" class="grid"></div>
                
                <div id="quantum-instructions" class="quantum-instructions"></div>
            </div>
        </div>
    </div>

    <script>
        // ========== CONSTANTS AND DATA ==========
        const spirits = {
            1:"Centipede",2:"Old Lady",3:"Carriage",4:"Dead Man",5:"Parson Man",6:"Belly",7:"Hog",8:"Tiger",
            9:"Cattle",10:"Monkey",11:"Corbeau",12:"King",13:"Crapaud",14:"Money",15:"Sick Woman",16:"Jamette",
            17:"Pigeon",18:"Water Boat",19:"Horse",20:"Dog",21:"Mouth",22:"Rat",23:"House",24:"Queen",
            25:"Morrocoy",26:"Fowl",27:"Little Snake",28:"Red Fish",29:"Opium Man",30:"House Cat",
            31:"Parson Wife",32:"Shrimp",33:"Spider",34:"Blind Man",35:"Big Snake",36:"Donkey"
        };
        
        const intervals = {
            1:12,2:13,3:13,4:11,5:11,6:11,7:12,8:12,9:11,10:13,11:11,12:12,13:12,14:11,15:12,
            16:10,17:13,18:11,19:12,20:10,21:11,22:13,23:12,24:11,25:12,26:12,27:12,28:12,
            29:12,30:11,31:10,32:10,33:12,34:12,35:13,36:12
        };
        
        const numberColors = {
            "01":"#ff6b6b","02":"#ffa94d","03":"#ffd43b","04":"#69db7c","05":"#38d9a9","06":"#4dabf7",
            "07":"#9775fa","08":"#f783ac","09":"#ff922b","10":"#fab005","11":"#82c91e","12":"#20c997",
            "13":"#339af0","14":"#845ef7","15":"#e599f7","16":"#ff8787","17":"#ffc078","18":"#ffe066",
            "19":"#8ce99a","20":"#63e6be","21":"#74c0fc","22":"#b197fc","23":"#faa2c1","24":"#ffa8a8",
            "25":"#ffec99","26":"#c0eb75","27":"#96f2d7","28":"#a5d8ff","29":"#d0bfff","30":"#fcc2d7",
            "31":"#ff6b6b","32":"#ffa94d","33":"#ffd43b","34":"#69db7c","35":"#4dabf7","36":"#9775fa"
        };
        
        const markColors = {
            WB:{bg:"#ffffff",txt:"#000000"},
            PB:{bg:"#ffd700",txt:"#000000"},
            GB:{bg:"#ffd700",txt:"#000000"},
            MB:{bg:"#cc0000",txt:"#ffffff"},
            MU:{bg:"#cc0000",txt:"#ffffff"},
            MX:{bg:"#cc0000",txt:"#ffffff"}
        };
        
        // ========== QUANTUM CHART DATA (From first code) ==========
        const quantumData = [
            [[1,5,17],[2,6,18],[3,7,19]],[[4,8,20],[5,9,21],[6,10,22]],
            [[7,11,23],[8,12,24],[9,13,25]],[[10,14,26],[11,15,27],[12,16,28]],
            [[13,17,29],[14,18,30],[15,19,31]],[[16,20,32],[17,21,33],[18,22,34]],
            [[19,23,35],[20,24,36],[21,25,1]],[[22,26,2],[23,27,3],[24,28,4]],
            [[25,29,5],[26,30,6],[27,31,7]],[[28,32,8],[29,33,9],[30,34,10]],
            [[31,35,11],[32,36,12],[33,1,13]],[[34,2,14],[35,3,15],[36,4,16]]
        ];
        
        const sixteenGroups = [
            [1,16,29], [2,17,30], [3,18,31], [4,19,32], [5,20,33], [6,21,34], [7,22,35], [8,23,36],
            [9,24,1], [10,25,2], [11,26,3], [12,27,4], [13,28,5], [14,29,6], [15,30,7], [16,31,8],
            [17,32,9], [18,33,10], [19,34,11], [20,35,12], [21,36,13], [22,1,14], [23,2,15], [24,3,16],
            [25,4,17], [26,5,18], [27,6,19], [28,7,20], [29,8,21], [30,9,22], [31,10,23], [32,11,24],
            [33,12,25], [34,13,26], [35,14,27], [36,15,28]
        ];
        
        const bankBlocking = {
            1:[10,34], 2:[11,35,10,34], 3:[12,36], 4:[12,13,36,1], 5:[14,2], 6:[2,3,14,15], 7:[4,16], 8:[4,5,16,17],
            9:[6,18], 10:[1,2,19,20], 11:[2,21,27,15], 12:[3,4,22,23], 13:[4,24], 14:[5,6,25,26], 15:[6,27],
            16:[7,8,19,28], 17:[8,29], 18:[9,21], 19:[16,28,32,7], 20:[17,29,33,8], 21:[18,30], 22:[18,19,30,31],
            23:[20,32], 24:[20,21,32,33], 25:[22,34], 26:[22,23,34,35], 27:[24,36,12,15], 28:[19,20,16,17],
            29:[16,20], 30:[17,21], 31:[18,22], 32:[19,23], 33:[20,24], 34:[1,2,25,26], 35:[2,27], 36:[3,4,28,29]
        };
        
        const luckyDiamond = {
            1:[36], 2:[33], 3:[34], 4:[35], 5:[1], 6:[2], 7:[3], 8:[4], 9:[20,28], 10:[21,29], 11:[22,30],
            12:[19,31], 13:[24], 14:[25], 15:[26], 16:[27], 17:[28], 18:[29], 19:[8,12], 20:[9], 21:[10,16],
            22:[11,15], 23:[12], 24:[13], 25:[14], 26:[15], 27:[16], 28:[17], 29:[18], 30:[19], 31:[20],
            32:[21], 33:[22], 34:[23], 35:[24], 36:[1,25]
        };
        
        // ========== GLOBAL VARIABLES ==========
        let timeline = [];
        let markInfo = {};
        let currentWeekHits = {};
        let outstandingBuckets = {};
        let marks = [];
        let jsNowTs = Date.now();
        
        // Quantum Chart Variables
        let quantumView = 'Matrix';
        let selectedQuantumNum = 27;
        
        // ========== INITIALIZATION ==========
        document.addEventListener('DOMContentLoaded', async function() {
            startSplash();
            initializeQuantumChart();
            
            // Load data from your APIs
            await loadData();
            
            // Setup ticker
            setupTicker();
        });
        
        // ========== QUANTUM CHART FUNCTIONS (From first code) ==========
        function initializeQuantumChart() {
            const gridEl = document.getElementById('grid');
            if (!gridEl) return;
            
            gridEl.innerHTML = '';
            quantumData.forEach(set => {
                set.forEach(trip => {
                    const d = document.createElement('div');
                    d.className = 'triplet';
                    trip.forEach(n => {
                        const c = document.createElement('div');
                        c.className = 'cell';
                        c.textContent = n;
                        c.onclick = () => updateQuantumDisplay(n);
                        d.appendChild(c);
                    });
                    gridEl.appendChild(d);
                });
            });
            updateQuantumDisplay(selectedQuantumNum);
        }
        
        function updateQuantumDisplay(num) {
            selectedQuantumNum = num;
            const cells = document.querySelectorAll('#grid .cell');
            
            cells.forEach(el => {
                el.classList.remove('highlight', 'dim');
                if (parseInt(el.textContent) === num) {
                    el.classList.add('highlight');
                } else {
                    el.classList.add('dim');
                }
            });
            
            const eight = quantumData.flat().filter(t => t.includes(num));
            const sixteen = sixteenGroups.filter(t => t.includes(num));
            
            let html = `
                <div class="chart-tabs">
                    <div class="chart-tab ${quantumView === 'Matrix' ? 'active' : ''}" onclick="setQuantumView('Matrix')">1/8 & 1/16 Chart</div>
                    <div class="chart-tab ${quantumView === 'Bank' ? 'active' : ''}" onclick="setQuantumView('Bank')">Bank Chart</div>
                    <div class="chart-tab ${quantumView === 'Diamond' ? 'active' : ''}" onclick="setQuantumView('Diamond')">Diamond Chart</div>
                </div>
                <h3 style="color:var(--neon);margin:5px 0 10px;">MARK: #${num}</h3>
            `;
            
            if (quantumView === 'Matrix') {
                html += `<div class="comparison">
                    <div class="column"><h4>1/8 CHART</h4>${eight.map(g => '<div style="font-size:12px;margin:2px 0;">' + g.join(', ') + '</div>').join('')}</div>
                    <div class="column"><h4>1/16 CHART</h4>${sixteen.map(g => '<div style="font-size:12px;margin:2px 0;">' + g.join(', ') + '</div>').join('')}</div>
                </div>`;
            } else if (quantumView === 'Bank') {
                const b = bankBlocking[num] || ["Check Sequence"];
                html += `<div class="column data-box"><h4>Blocking Marks</h4><div class="data-val">${b.join(' ‚Ä¢ ')}</div><p style="font-size:9px;color:#64748b;">Hedge these marks against your main play.</p></div>`;
            } else if (quantumView === 'Diamond') {
                const d = luckyDiamond[num] || ["Neutral"];
                html += `<div class="column data-box"><h4>Lucky Diamond Chart</h4><div class="data-val" style="color:var(--neon)">${d.join(' ‚Ä¢ ')}</div><p class="diamond-text">"The mirror reflection of the current sequence."</p></div>`;
            }
            
            const instructionsEl = document.getElementById('quantum-instructions');
            if (instructionsEl) {
                instructionsEl.innerHTML = html;
            }
        }
        
        function setQuantumView(v) {
            quantumView = v;
            updateQuantumDisplay(selectedQuantumNum);
        }
        
        function randomPick() {
            const r = Math.floor(Math.random() * 36) + 1;
            updateQuantumDisplay(r);
        }
        
        // ========== DATA LOADING ==========
        async function loadData() {
            try {
                // These are your actual API endpoints
                const PLAY_WHE_URL = "https://script.google.com/macros/s/AKfycbwyr-M_ZzIscNgxJmR_UYHgZqmamn62Np4msDFaCjX9KgyUmyjuzuIYbawBmT0_mw4j/exec?action=calendar&game=P2WHE&weeks=159";
                const TICKER_URL = "https://script.google.com/macros/s/AKfycbymSUZ3cuBP7wZSKkxs8QmjMkKP6q3j-LOW_CVpY3n6Sw1EzsdwPu6yTEkpOmiAJz95/exec?action=ticker";
                
                // Load main data
                const response = await fetch(PLAY_WHE_URL);
                const json = await response.json();
                
                // Process data EXACTLY as in your second code
                processData(json.data.weeks);
                
                // Render all tabs
                renderShelfTab();
                renderDrawsTab();
                renderOutstandingTable();
                
            } catch (error) {
                console.error('Error loading data:', error);
                // Fallback to sample data if API fails
                loadSampleData();
            }
        }
        
        function processData(weeks) {
            // EXACT data processing logic from your second code
            const dayOrder = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const timeOrder = ["MOR", "MID", "NON", "EVE"];
            const timeNames = { MOR: "Morning", MID: "Midday", NON: "Afternoon", EVE: "Evening" };
            
            // Reset data structures
            timeline = [];
            markInfo = {};
            currentWeekHits = {};
            const lastSeenDate = {}, lastSeenTime = {}, frequency = {};
            
            // Sort weeks chronologically
            weeks.sort((a, b) => {
                let pa = a.startDate.split(" ");
                let pb = b.startDate.split(" ");
                return new Date(`${pa[2]}-${pa[1]}-${pa[0]}`) - new Date(`${pb[2]}-${pb[1]}-${pb[0]}`);
            });
            
            for (let week of weeks) {
                let parts = week.startDate.split(" ");
                let monthMap = {"Jan":0,"Feb":1,"Mar":2,"Apr":3,"May":4,"Jun":5,"Jul":6,"Aug":7,"Sep":8,"Oct":9,"Nov":10,"Dec":11};
                let startDate = new Date(parts[2], monthMap[parts[1]], parts[0]);
                
                for (let day of week.days) {
                    let dDate = new Date(startDate);
                    dDate.setDate(dDate.getDate() + dayOrder.indexOf(day.dayName));
                    
                    for (let t of timeOrder) {
                        let n = day.draws[t];
                        if (!n || n === "-" || n === "PENDING") continue;
                        let num = parseInt(n);
                        if (num < 1 || num > 36) continue;
                        
                        // Track current week hits for widget
                        if (week.isCurrentWeek === true) {
                            currentWeekHits[num] = (currentWeekHits[num] || 0) + 1;
                        }
                        
                        // Track frequency and last seen for widget
                        frequency[num] = (frequency[num] || 0) + 1;
                        lastSeenDate[num] = dDate;
                        lastSeenTime[num] = timeNames[t];
                        
                        // Original timeline processing
                        let entry = { 
                            num, 
                            date: dDate.getTime(), 
                            dateStr: dDate.toLocaleDateString("en-GB", {weekday:"short", day:"2-digit", month:"short", year: "numeric"}).toUpperCase(), 
                            dayName: day.dayName, 
                            timeSlot: t, 
                            time: timeNames[t] 
                        };
                        timeline.push(entry);
                        
                        if (!(num in markInfo)) { 
                            markInfo[num] = { 
                                frequency: 0, 
                                lastDate: null, 
                                history: [], 
                                nextNums: {} 
                            }; 
                        }
                        markInfo[num].frequency++;
                        markInfo[num].lastDate = dDate;
                        markInfo[num].history.push({ 
                            date: entry.dateStr, 
                            time: entry.time, 
                            ts: entry.date 
                        });
                        
                        if (timeline.length > 1) {
                            let prev = timeline[timeline.length - 2];
                            if (markInfo[prev.num]) {
                                markInfo[prev.num].nextNums[num] = (markInfo[prev.num].nextNums[num] || 0) + 1;
                            }
                        }
                    }
                }
            }
            
            // Generate marks array EXACTLY as in your code
            marks = [];
            let now = new Date();
            for (let n = 1; n <= 36; n++) {
                let info = markInfo[n] || { frequency: 0, lastDate: null };
                let daysAgo = info.lastDate ? Math.floor((now.getTime() - info.lastDate.getTime()) / 86400000) : 999;
                let avg = intervals[n] || 12;
                let dLeft = avg - daysAgo;
                let status = (dLeft <= 0) ? "OVERDUE" : (dLeft <= 2 ? "CLOSE" : "NORMAL");
                
                marks.push({ 
                    num: n, 
                    spirit: spirits[n], 
                    date: info.lastDate ? info.lastDate.toLocaleDateString("en-GB", {day:"2-digit", month:"short", year: "numeric"}).toUpperCase() : "N/A", 
                    days: daysAgo, 
                    dLeft, 
                    status, 
                    avg, 
                    frequency: info.frequency,
                    time: lastSeenTime[n] || "N/A",
                    isHitThisWeek: !!currentWeekHits[n]
                });
            }
            marks.sort((a,b) => b.days - a.days);
            
            // Calculate marks outstanding EXACTLY as in your code
            let weeksForOutstanding = weeks.slice().reverse(); // Recent first
            outstandingBuckets = { "THIS": [] };
            for (let i = 0; i < 12; i++) outstandingBuckets[i] = [];
            
            for (let n = 1; n <= 36; n++) {
                if (currentWeekHits[n]) {
                    outstandingBuckets["THIS"].push({num: n, freq: currentWeekHits[n]});
                    continue;
                }
                let found = false;
                for (let i = 1; i < weeksForOutstanding.length && i <= 12; i++) {
                    let weekData = weeksForOutstanding[i];
                    let weekNums = new Set();
                    weekData.days.forEach(d => Object.values(d.draws).forEach(v => {
                        if(v && v !== "-" && v !== "PENDING") weekNums.add(parseInt(v));
                    }));
                    
                    if (weekNums.has(n)) {
                        outstandingBuckets[i-1].push(n);
                        found = true;
                        break;
                    }
                }
            }
            
            jsNowTs = now.getTime();
        }
        
        function loadSampleData() {
            // Generate sample data matching your structure
            const sampleWeeks = [];
            const now = new Date();
            const dayOrder = ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"];
            const timeOrder = ["MOR", "MID", "NON", "EVE"];
            
            for (let w = 0; w < 12; w++) {
                const weekStart = new Date(now.getTime() - (w * 7 * 86400000));
                const week = {
                    startDate: weekStart.toLocaleDateString("en-GB", {day:"2-digit", month:"short", year:"numeric"}),
                    isCurrentWeek: w === 0,
                    days: []
                };
                
                for (let d = 0; d < 6; d++) {
                    const dayDate = new Date(weekStart.getTime() + (d * 86400000));
                    const day = {
                        dayName: dayOrder[d],
                        draws: {}
                    };
                    
                    for (let t = 0; t < 4; t++) {
                        // Generate realistic data
                        let drawNum = Math.floor(Math.random() * 36) + 1;
                        // Make some numbers appear more frequently
                        if (Math.random() > 0.7) {
                            drawNum = Math.floor(Math.random() * 12) + 1; // Hot numbers 1-12
                        }
                        day.draws[timeOrder[t]] = drawNum.toString();
                    }
                    
                    week.days.push(day);
                }
                
                sampleWeeks.push(week);
            }
            
            processData(sampleWeeks);
        }
        
        // ========== RENDERING FUNCTIONS ==========
        function renderShelfTab() {
            const shelfTab = document.getElementById('shelf-tab');
            if (!shelfTab) return;
            
            shelfTab.innerHTML = marks.map(m => `
                <div class="card data-card" data-search="${m.num} ${m.spirit}">
                    <div style="display:flex; align-items:center; justify-content:space-between;">
                        <div class="ball-big" style="background:${numberColors[String(m.num).padStart(2,'0')]}">${m.num}</div>
                        <div style="flex:1; margin-left:15px;">
                            <div style="font-weight:800; font-size:16px;">${m.spirit}</div>
                            <div style="font-size:11px; color:var(--sec);">${m.date}</div>
                        </div>
                        <div style="text-align:right;">
                            <div style="font-weight:900; font-size:20px; color:${m.days > m.avg ? 'var(--danger)' : 'var(--success)'}">${m.days}d ago</div>
                            <div class="due-tag" style="background:${m.status==='OVERDUE'?'var(--danger)':(m.status==='CLOSE'?'var(--warn)':'#333')}; color:#fff">
                                ${m.status==='OVERDUE'?'TODAY':(m.status==='CLOSE'?'CLOSE':m.dLeft+'d left')}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');
        }
        
        function renderDrawsTab() {
            const drawsTab = document.getElementById('draws-tab');
            if (!drawsTab) return;
            
            drawsTab.innerHTML = marks.map((m, idx) => {
                let follows = Object.entries(markInfo[m.num]?.nextNums || {}).sort((a,b) => b[1] - a[1]).slice(0,4);
                return `
                <div class="card data-card" data-search="${m.num} ${m.spirit}" onclick="toggle(${idx})">
                    <div style="display:flex; align-items:center; justify-content:space-between;">
                        <div style="display:flex; align-items:center;">
                            <div style="background:#fff; width:30px; height:30px; border-radius:50%; color:#000; display:flex; align-items:center; justify-content:center; font-weight:bold;">${m.num}</div>
                            <div style="margin-left:10px; font-weight:bold;">${m.spirit}</div>
                        </div>
                        <div style="text-align:right">
                            <div style="font-size:14px; color:var(--warn); font-weight:bold;"> ${m.frequency}x PLAYED</div>
                            <div style="font-size:10px; color:var(--accent);">VIEW ‚ñæ</div>
                        </div>
                    </div>
                    <div id="p-${idx}" class="panel">
                        <div style="font-size:11px; color:var(--warn); margin-bottom:10px; font-weight:bold;">LIKELY FOLLOWS:</div>
                        <div style="display:flex; gap:10px; margin-bottom:15px;">
                            ${follows.map(f => `<div style="background:var(--accent); padding:5px 10px; border-radius:6px; font-weight:800;">#${f[0]}</div>`).join('')}
                        </div>
                        <table class="table">
                            <tr>
                                <th>MARK</th>
                                <th>DATE PLAYED</th>
                                <th>DRAW TIME</th>
                                <th>DAYS AGO</th>
                            </tr>
                            ${(markInfo[m.num]?.history || []).slice().reverse().slice(0,20).map(h => {
                                let ago = Math.floor((jsNowTs - h.ts)/86400000);
                                return `<tr><td>${m.num}</td><td>${h.date}</td><td>${h.time}</td><td>${ago} days ago</td></tr>`;
                            }).join('')}
                        </table>
                    </div>
                </div>`;
            }).join('');
        }
        
        function renderOutstandingTable() {
            const outTable = document.getElementById('outstanding-table');
            if (!outTable) return;
            
            outTable.innerHTML = `
                <div style="font-size:18px; color:gray; margin-bottom:8px; text-align:center;">AGING ANALYSIS (LAST 12 WEEKS)</div>
                ${Object.keys(outstandingBuckets).filter(k => outstandingBuckets[k].length > 0).sort((a,b) => {
                    if(a==="THIS") return -1; if(b==="THIS") return 1; return a-b;
                }).map(k => {
                    let label = k === "THIS" ? "THIS WEEK" : (k === "0" ? "LAST WEEK" : k + " WEEKS AGO");
                    let content = "";
                    if(k === "THIS") {
                        content = outstandingBuckets[k].map(obj => {
                            let color = obj.freq >= 4 ? "#ff453a" : (obj.freq === 3 ? "#ff9f0a" : (obj.freq === 2 ? "#32d74b" : "#007AFF"));
                            return `<span class="ball-small" style="background:${color}">${String(obj.num).padStart(2,'0')}</span>`;
                        }).join('');
                    } else {
                        content = `<span class="out-nums">${outstandingBuckets[k].sort((a,b)=>a-b).map(n => String(n).padStart(2,'0')).join(' ')}</span>`;
                    }
                    return `<div class="out-row"><span class="out-label">${label}</span><div>${content}</div></div>`;
                }).join('')}
            `;
        }
        
        // ========== TICKER FUNCTIONS ==========
        function setupTicker() {
            updateTicker();
            setInterval(updateTicker, 60000);
        }
        
        async function updateTicker() {
            try {
                const TICKER_URL = "https://script.google.com/macros/s/AKfycbymSUZ3cuBP7wZSKkxs8QmjMkKP6q3j-LOW_CVpY3n6Sw1EzsdwPu6yTEkpOmiAJz95/exec?action=ticker";
                const response = await fetch(`${TICKER_URL}&_t=${new Date().getTime()}`);
                const data = await response.json();
                const allGames = data.games || {};
                
                const tickerContent = buildAllDrawsRibbon(allGames);
                const ribbons = ['tickerRibbon1', 'tickerRibbon2', 'tickerRibbon3', 'tickerRibbon4'];
                
                ribbons.forEach(ribbonId => {
                    const ribbon = document.getElementById(ribbonId);
                    if (ribbon) {
                        ribbon.innerHTML = tickerContent;
                    }
                });
            } catch (error) {
                console.log('Ticker update failed:', error);
                // Fallback to sample ticker
                const sampleGames = {
                    PLAYWHE: [
                        { time: "10:00 AM", name: "Morning", numbers: "16 JAMETTE (WB,PB)" },
                        { time: "1:00 PM", name: "Midday", numbers: "29 OPIUM MAN (GB)" }
                    ],
                    PICK2: [
                        { time: "10:05 AM", name: "PICK 2", numbers: "12/34 x2" }
                    ],
                    PICK4: [
                        { time: "10:10 AM", name: "PICK 4", numbers: "1234" }
                    ]
                };
                
                const tickerContent = buildAllDrawsRibbon(sampleGames);
                const ribbons = ['tickerRibbon1', 'tickerRibbon2', 'tickerRibbon3', 'tickerRibbon4'];
                ribbons.forEach(ribbonId => {
                    const ribbon = document.getElementById(ribbonId);
                    if (ribbon) {
                        ribbon.innerHTML = tickerContent;
                    }
                });
            }
        }
        
        function buildAllDrawsRibbon(allGames) {
            if (!allGames || Object.keys(allGames).length === 0) {
                return '<span style="color:#666;">‚ô†Ô∏èFSP‚Ä¢SAGi: Initializing...</span>';
            }
            
            let html = '<div class="live-dot">LIVE</div>';
            
            // Process PLAY WHE if available
            if (allGames.PLAYWHE && allGames.PLAYWHE.length > 0) {
                allGames.PLAYWHE.forEach(draw => {
                    const numMatch = draw.numbers.match(/^(\d+)/);
                    const num = numMatch ? numMatch[1].padStart(2, '0') : '--';
                    const color = num !== '--' ? (numberColors[num] || '#ffffff') : '#333333';
                    const spiritMatch = draw.numbers.match(/\d+\s+(.+?)\s+\(/);
                    const spiritName = spiritMatch ? spiritMatch[1].trim() : "";
                    const marks = (draw.numbers.match(/\(([^)]+)\)/)?.[1] || "").split(',').map(m => m.trim()).filter(m => m);
                    
                    html += createTickerItem(draw.time + ' ' + draw.name, 
                        generateBall(num, color, '#000') + marks.map(m => generateMarkBall(m)).join(''),
                        spiritName);
                });
            }
            
            // Process PICK 2 if available
            if (allGames.PICK2 && allGames.PICK2.length > 0) {
                allGames.PICK2.forEach(p2 => {
                    const parts = p2.numbers.trim().split(" ");
                    const pair = (parts[0] || "").split("/");
                    const mult = parts[1] || "";
                    if (pair.length < 2) return;
                    
                    const ballsHtml = generateBall(pair[0], "#054517", "#ffff00", true) + 
                                     generateBall(pair[1], "#ffff00", "#000000", true) +
                                     (mult ? generateMarkBall(mult) : "");
                    
                    html += createTickerItem(p2.time + ' ' + p2.name, ballsHtml, "Pick 2 Results");
                });
            }
            
            // Process PICK 4 if available
            if (allGames.PICK4 && allGames.PICK4.length > 0) {
                allGames.PICK4.forEach(p4 => {
                    const p4Nums = p4.numbers.match(/.{2}/g) || [];
                    const p4Colors = ["#ff0000", "#ffff00", "#00ff00", "#ffffff"];
                    const p4Texts = ["#ffffff", "#000000", "#000000", "#000000"];
                    
                    const ballsHtml = p4Nums.map((n, i) => generateBall(n, p4Colors[i], p4Texts[i])).join('');
                    
                    html += createTickerItem(p4.time + ' ' + p4.name, ballsHtml, "Pick 4 Results");
                });
            }
            
            return html;
        }
        
        function generateBall(num, bg, txt, forceSingle = false) {
            const parsedNum = parseInt(num, 10);
            const displayNum = isNaN(parsedNum) ? num : parsedNum.toString();
            return '<span class="ticker-number" style="background:' + bg + '; color:' + txt + '; margin-right:4px;">' + displayNum + '</span>';
        }
        
        function generateMarkBall(mk) {
            const c = markColors[mk] || {bg:"#ffffff", txt:"#000000"};
            return '<span style="width:25px; height:25px; line-height:25px; border-radius:11px; background:' + c.bg + '; color:' + c.txt + '; font-size:14px; font-weight:900; text-align:center; display:inline-block; box-shadow:0 2px 4px rgba(0,0,0,0.3); margin-right:4px;">' + mk + '</span>';
        }
        
        function createTickerItem(time, balls, label) {
            return '<div class="ticker-draw">' +
                   '  <span class="ticker-time">' + time + '</span>' +
                   '  <div style="display:flex; align-items:center; margin-top:2px;">' + balls + '</div>' +
                   '  <div style="color:#fff; font-size:11px; font-weight:bold; margin-top:2px; opacity:0.8;">' + label + '</div>' +
                   '</div>';
        }
        
        // ========== UI FUNCTIONS ==========
        function show(t, el) {
            document.getElementById('shelf-tab').style.display = t === 'shelf' ? 'block' : 'none';
            document.getElementById('draws-tab').style.display = t === 'draws' ? 'block' : 'none';
            document.getElementById('analyzer-tab').style.display = t === 'analyzer' ? 'block' : 'none';
            document.getElementById('quantum-tab').style.display = t === 'quantum' ? 'block' : 'none';
            
            document.getElementById('masterSearch').style.display = (t === 'analyzer' || t === 'quantum') ? 'none' : 'block';
            
            document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
            el.classList.add('active');
            window.scrollTo(0,0);
        }
        
        function toggle(i) {
            let p = document.getElementById('p-' + i);
            p.style.display = p.style.display === 'block' ? 'none' : 'block';
        }
        
        function toggleOutstanding() {
            let p = document.getElementById('outstanding-table');
            let btn = document.getElementById('outBtn');
            if (p.style.display === 'block') {
                p.style.display = 'none';
                btn.innerHTML = 'üßÆ MARKS OUTSTANDING ‚ñæ';
            } else {
                p.style.display = 'block';
                btn.innerHTML = 'üßÆ MARKS OUTSTANDING ‚ñ¥';
            }
        }
        
        function doSearch() {
            let q = document.getElementById('masterSearch').value.toLowerCase();
            document.querySelectorAll('.data-card').forEach(c => {
                c.style.display = c.getAttribute('data-search').toLowerCase().includes(q) ? 'block' : 'none';
            });
        }
        
        function runDeepSearch() {
            const d = document.getElementById('sDay').value;
            const t = document.getElementById('sTime').value;
            const s = parseInt(document.getElementById('sScope').value);
            
            const targeted = timeline.slice(-(s * 24));
            const counts = {};
            const logs = {};
            
            targeted.forEach(x => {
                if (x.dayName === d && (t === 'ALL' || x.timeSlot === t)) {
                    counts[x.num] = (counts[x.num] || 0) + 1;
                    if (!logs[x.num]) logs[x.num] = [];
                    logs[x.num].push(x);
                }
            });
            
            let sorted = Object.entries(counts).sort((a,b) => b[1] - a[1]).slice(0,10);
            
            document.getElementById('res').innerHTML = sorted.map(([n, c]) => {
                let rows = logs[n].slice().reverse().slice(0,10).map(l => {
                    const ago = Math.floor((jsNowTs - l.date)/86400000);
                    return `<tr><td>${l.dateStr}</td><td>${l.time}</td><td>${ago}d</td></tr>`;
                }).join('');
                
                return `<div style="background:#111; padding:12px; border-radius:12px; margin-bottom:12px; border-left:4px solid var(--accent);">
                    <div style="display:flex; justify-content:space-between; align-items:center;">
                        <div><span style="font-weight:900; font-size:18px;">#${n}</span> <span style="font-size:12px; color:var(--sec);">${spirits[n]}</span></div>
                        <div style="color:var(--success); font-weight:900;">${c} HITS</div>
                    </div>
                    <table class="table">${rows}</table>
                </div>`;
            }).join('') || '<div style="text-align:center; color:gray;">No Data Found</div>';
        }
        
        // ========== SPLASH SCREEN FUNCTIONS ==========
        function makeFace(num) {
            const face = document.createElement('div');
            face.className = 'face face--' + num;
            const dot = '<div class="dot"></div>';
            const dots = {
                1: dot,
                2: '<div class="dots">' + dot + '<div></div><div></div><div></div><div></div><div></div><div></div><div></div>' + dot + '</div>',
                3: '<div class="dots">' + dot + '<div></div><div></div><div></div>' + dot + '<div></div><div></div><div></div>' + dot + '</div>',
                4: '<div class="dots">' + dot + '<div></div>' + dot + '<div></div><div></div><div></div>' + dot + '<div></div>' + dot + '</div>',
                5: '<div class="dots">' + dot + '<div></div>' + dot + '<div></div>' + dot + '<div></div>' + dot + '<div></div>' + dot + '</div>',
                6: '<div class="dots">' + dot + dot + dot + dot + dot + dot + '</div>'
            };
            face.innerHTML = dots[num] || '';
            return face;
        }
        
        function rollDice(cubeId) {
            const cube = document.getElementById(cubeId);
            cube.innerHTML = '';
            for (let i = 1; i <= 6; i++) cube.appendChild(makeFace(i));
            
            const result = Math.floor(Math.random() * 6) + 1;
            const rotations = {
                1: 'rotateX(0deg) rotateY(0deg)',
                2: 'rotateY(-90deg)',
                3: 'rotateY(180deg)',
                4: 'rotateY(90deg)',
                5: 'rotateX(-90deg)',
                6: 'rotateX(90deg)'
            };
            
            // High-speed pre-spin
            cube.style.transform = 'rotateX(720deg) rotateY(720deg)';
            
            setTimeout(() => {
                cube.style.transform = rotations[result];
            }, 100);
        }
        
        function startSplash() {
            rollDice('cube1');
            rollDice('cube2');
            
            setTimeout(() => {
                document.getElementById('revealText').classList.add('show');
            }, 1200);
            
            setTimeout(() => {
                const splash = document.getElementById('splash-screen');
                const main = document.getElementById('main-content');
                
                splash.classList.add('fade-out');
                
                setTimeout(() => {
                    splash.style.display = 'none';
                    main.style.display = 'block';
                    setTimeout(() => main.classList.add('show'), 50);
                }, 800);
            }, 3500);
        }
    </script>
</body>
</html>
