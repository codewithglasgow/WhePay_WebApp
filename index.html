<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>WhePay â€¢ Shelf Analysis & Quantum Mapping</title>
    <style>
        :root {
            --bg: #000000; --card: #1c1c1e; --accent: #007AFF;
            --success: #32d74b; --warn: #ff9f0a; --danger: #ff453a;
            --sec: #8e8e93; --purple: #af52de; --neon: #00f2ff;
            --dark-bg: #020617; --slate: #1e293b;
        }
        * { box-sizing: border-box; }
        body { background: var(--bg); color: #ffffff; font-family: -apple-system, sans-serif; margin: 0; padding: 0; overflow-x: hidden; min-height: 100vh; }
        
        /* SPLASH SCREEN */
        #splash-screen { position: fixed; inset: 0; z-index: 9999; background: #020617; display: flex; align-items: center; justify-content: center; transition: opacity 0.8s ease-out; }
        .stage { width: 100%; height: 100%; display: flex; flex-direction: row; align-items: center; justify-content: space-around; perspective: 800px; padding: 0 5vw; }
        .scene { width: 18vw; height: 18vw; max-width: 70px; max-height: 70px; position: relative; }
        .cube { width: 100%; height: 100%; position: absolute; transform-style: preserve-3d; transition: transform 2s cubic-bezier(0.17, 0.67, 0.83, 0.67); }
        .face { position: absolute; width: 100%; height: 100%; background: #ffffff; border-radius: 12%; display: flex; align-items: center; justify-content: center; box-shadow: inset 0 0 10px rgba(0,0,0,0.2); backface-visibility: hidden; }
        .face--1 { transform: rotateY(0deg) translateZ(9vw); } .face--2 { transform: rotateY(90deg) translateZ(9vw); } .face--3 { transform: rotateY(180deg) translateZ(9vw); } .face--4 { transform: rotateY(-90deg) translateZ(9vw); } .face--5 { transform: rotateX(90deg) translateZ(9vw); } .face--6 { transform: rotateX(-90deg) translateZ(9vw); }
        @media (min-width: 400px) { .face--1 { transform: rotateY(0deg) translateZ(35px); } .face--2 { transform: rotateY(90deg) translateZ(35px); } .face--3 { transform: rotateY(180deg) translateZ(35px); } .face--4 { transform: rotateY(-90deg) translateZ(35px); } .face--5 { transform: rotateX(90deg) translateZ(35px); } .face--6 { transform: rotateX(-90deg) translateZ(35px); } }
        .dot { width: 2.5vw; height: 2.5vw; max-width: 8px; max-height: 8px; background: #111; border-radius: 50%; }
        .dots { display: grid; gap: 1vw; grid-template-columns: repeat(3, 1fr); }
        .reveal { text-align: center; opacity: 0; transform: translateY(20px); transition: all 0.8s ease-out; flex: 1; }
        .reveal.show { opacity: 1; transform: translateY(0); }
        .title { font-size: 7vw; font-weight: 900; color: #fff; margin: 0; white-space: nowrap; }
        .subtitle { font-size: 3.5vw; color: #58a6ff; margin-top: 5px; white-space: nowrap; }
        .fade-out { opacity: 0 !important; pointer-events: none; }

        /* TICKER */
        .ticker-fixed { background: linear-gradient(to bottom, #111, #000); border-bottom: 1px solid #333; padding: 0px 12px; position: sticky; top: 0; z-index: 1000; width: 100%; box-shadow: 0 4px 10px rgba(0,0,0,0.6); height: 75px; display: flex; align-items: center; overflow: hidden; }
        .ticker-ribbon { display: flex; gap: 30px; animation: scroll 20s linear infinite; white-space: nowrap; padding-left: 20px; will-change: transform; }
        @keyframes scroll { from { transform: translateX(0); } to { transform: translateX(-100%); } }
        .live-dot { display: inline-flex; align-items: center; gap: 8px; color: #ff0000; font-weight: bold; font-size: 16px; flex-shrink: 0; animation: pulse-red 1.8s infinite; margin-right: 20px; }
        .ticker-draw { display: flex; flex-direction: column; align-items: center; margin-right: 30px; padding-top: 4px; }
        .ticker-time { color: #ffa500; font-weight: bold; min-width: 110px; text-align: right; }
        .ticker-number { width: 25px; height: 25px; line-height: 25px; border-radius: 20px; font-weight: bold; font-size: 18px; text-align: center; color: #000; box-shadow: 0 4px 12px rgba(0,0,0,0.5); flex-shrink: 0; margin-right: 4px; }

        /* NAVIGATION */
        .nav { position: sticky; top: 75px; width: 100%; background: rgba(28,28,30,0.9); backdrop-filter: blur(20px); z-index: 100; padding: 12px; border-bottom: 0.5px solid #333; }
        .search-box { width: 100%; background: #1c1c1e; border: 1px solid #333; border-radius: 8px; padding: 10px; color: white; margin-top: 5px; font-size: 14px; }
        .tabs { display: flex; gap: 6px; margin-bottom: 10px; overflow-x: auto; }
        .tab { flex: 1; min-width: 100px; background: #2c2c2e; border: none; color: #fff; padding: 12px; border-radius: 10px; font-weight: 800; font-size: 14px; cursor: pointer; text-align: center; }
        .tab.active { background: var(--accent); }
        .dropdown-btn { width: 100%; background: #2c2c2e; color: var(--success); border: 1px solid #444; padding: 10px; border-radius: 8px; margin: 10px 0; font-weight: 800; font-size: 14px; text-align: center; cursor: pointer; }
        .outstanding-panel { display: none; background: #111; border-radius: 10px; padding: 10px; margin-bottom: 15px; border: 1px solid #333; }
        .out-row { display: flex; justify-content: space-between; padding: 8px 0; border-bottom: 0.5px solid #222; align-items: center; }
        .out-label { color: var(--accent); font-weight: bold; font-size: 12px; }
        .out-nums { color: #fff; font-family: monospace; font-size: 14px; }
        .ball-small { display: inline-block; width: 22px; height: 22px; line-height: 22px; border-radius: 50%; text-align: center; font-size: 11px; font-weight: bold; margin-left: 4px; }

        /* CONTENT */
        .container { padding: 10px 5px; }
        .card { background: var(--card); border-radius: 14px; padding: 15px; margin-bottom: 12px; border: 0.5px solid #2c2c2e; }
        .ball-big { width: 45px; height: 45px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 22px; font-weight: 900; color: #000; }
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 6px; }
        .triplet { display: flex; border: 1px solid #334155; border-radius: 6px; background: rgba(30, 41, 59, 0.5); overflow: hidden; height: 42px; }
        .cell { flex: 1; display: flex; align-items: center; justify-content: center; border-right: 1px solid #334155; font-weight: 700; font-size: 13px; color: #94a3b8; cursor: pointer; }
        .cell.highlight { background: var(--neon) !important; color: #000 !important; }
        #main-content { display: none; opacity: 0; transition: opacity 0.5s ease-in; }
        #main-content.show { display: block; opacity: 1; }
    </style>
</head>
<body>
    <div id="splash-screen">
        <div class="stage">
            <div class="scene"><div class="cube" id="cube1"></div></div>
            <div class="reveal" id="revealText">
                <h1 class="title">WHE PAY</h1>
                <h1 class="title">SHELF ANALYSIS</h1>
                <p class="subtitle">CODEWITHGLASGOW</p>
            </div>
            <div class="scene"><div class="cube" id="cube2"></div></div>
        </div>
    </div>

    <div id="main-content">
        <div class="ticker-fixed">
            <div class="ticker-ribbon" id="tickerRibbon1"></div>
            <div class="ticker-ribbon" id="tickerRibbon2"></div>
        </div>

        <div class="nav">
            <div class="tabs">
                <button class="tab active" onclick="showTab('shelf', this)">SHELF</button>
                <button class="tab" onclick="showTab('draws', this)">DRAWS</button>
                <button class="tab" onclick="showTab('analyzer', this)">ANALYZER</button>
                <button class="tab" onclick="showTab('quantum', this)">QUANTUM CHART</button>
            </div>
            <input type="text" id="masterSearch" class="search-box" placeholder="Search Mark..." onkeyup="doSearch()">
            <button id="outBtn" class="dropdown-btn" onclick="toggleOutstanding()">ðŸ§® MARKS OUTSTANDING â–¾</button>
            <div id="outstanding-table" class="outstanding-panel"></div>
        </div>

        <div id="shelf-tab" class="container"></div>
        <div id="draws-tab" class="container" style="display:none;"></div>
        <div id="analyzer-tab" class="container" style="display:none;"></div>
        <div id="quantum-tab" class="container" style="display:none;"></div>
    </div>

    <script>
        // DATA & SPIRITS
        const spirits = {1:"Centipede",2:"Old Lady",3:"Carriage",4:"Dead Man",5:"Parson Man",6:"Belly",7:"Hog",8:"Tiger",9:"Cattle",10:"Monkey",11:"Corbeau",12:"King",13:"Crapaud",14:"Money",15:"Sick Woman",16:"Jamette",17:"Pigeon",18:"Water Boat",19:"Horse",20:"Dog",21:"Mouth",22:"Rat",23:"House",24:"Queen",25:"Morrocoy",26:"Fowl",27:"Little Snake",28:"Red Fish",29:"Opium Man",30:"House Cat",31:"Parson Wife",32:"Shrimp",33:"Spider",34:"Blind Man",35:"Big Snake",36:"Donkey"};
        
        // AGING LOGIC FIX: Authentic Week-by-Week Bucketing
        function generateOutstandingBuckets(weeksData) {
            let buckets = { "THIS": [] };
            for (let i = 0; i < 12; i++) buckets[i] = [];
            
            const revWeeks = [...weeksData].reverse(); // Most recent first
            
            for (let n = 1; n <= 36; n++) {
                let found = false;
                for (let w = 0; w < revWeeks.length && w < 13; w++) {
                    let weekNums = [];
                    revWeeks[w].days.forEach(d => Object.values(d.draws).forEach(v => {
                        if(v && v !== "-") weekNums.push(parseInt(v));
                    }));

                    if (weekNums.includes(n)) {
                        if (w === 0) {
                            let freq = weekNums.filter(x => x === n).length;
                            buckets["THIS"].push({num: n, freq: freq});
                        } else {
                            buckets[w-1].push(n);
                        }
                        found = true; break;
                    }
                }
                if (!found) buckets[11].push(n);
            }
            return buckets;
        }

        // Keep all other functions from your DeepSeek assembly...
        // (Simplified for brevity in response, but retain your ticker, splash, and navigation logic)
        
        function showTab(tabName, button) {
            document.querySelectorAll('.tab-content').forEach(c => c.style.display = 'none');
            document.getElementById(tabName + '-tab').style.display = 'block';
            document.querySelectorAll('.tab').forEach(b => b.classList.remove('active'));
            button.classList.add('active');
        }

        function toggleOutstanding() {
            const panel = document.getElementById('outstanding-table');
            panel.style.display = panel.style.display === 'block' ? 'none' : 'block';
        }

        // Initialize and Start Splash
        window.onload = () => {
            setTimeout(() => {
                document.getElementById('splash-screen').classList.add('fade-out');
                document.getElementById('main-content').style.display = 'block';
                setTimeout(() => document.getElementById('main-content').classList.add('show'), 50);
            }, 3000);
            // Call your data loading here...
        };
    </script>
</body>
</html>
